const h="/404";export function hydrate(t,...e){const n=typeof t=="string"?document.querySelector(t):t;if(!n)throw Error("Root element does not exist.");if(e[0]!==void 0&&typeof e[0]=="object"&&!Array.isArray(e[0])){let i=function(c){let f=document.location.hash.split("#")[1];(!f||!f.startsWith("/"))&&(f="/");let a;if(Object.hasOwn(c,f))a=c[f];else if(Object.hasOwn(c,h))a=c[h];else throw Error("404 - route not found.");r=refresh(n,[a],r)};const o=e[0];let r={};window.addEventListener("hashchange",()=>i(o)),i(o)}else refresh(n,e)}let b=-1;const y=[],l=[];export function refresh(t,e,n={}){b=-1;const o=t,r=e,f={$refresh:(s={afterRefreshCallback:void 0})=>{refresh(t,e,n),typeof s.afterRefreshCallback=="function"&&s.afterRefreshCallback()},$state:n,$root:o},a=[];for(let s of e){for(;typeof s=="function";)s=s(f);a.push(s)}const u=a.flat(1/0);t.replaceChildren(...u);for(const s of l)for(const p of Object.values(s))typeof p=="function"&&p({element:k(u),findElementByReference:w=>$(w,u)});return n}export function node(...t){const e=++b;return y[e]||(y[e]={}),l[e]||(l[e]={}),(n={})=>{let o;if(n.$componentState=y[e],n.$on_mount=l[e],t[0]!==void 0&&typeof t[0]=="string"){o=document.createElement(t[0]);let r;for(const[i,c]of t.entries())if(i>0){if(typeof c=="object"&&!Array.isArray(c)){c.$is_options=!0;const{ref:f,attr:a,class:u,event:s,props:p}=c;r={ref:f,attr:a,classList:u,event:s,props:p}}switch(typeof r=="object"&&!Array.isArray(r)&&g(o,r),typeof c){case"function":let f=c;for(;typeof f=="function";)f=f(n);Array.isArray(f)?(f=f.flat(1/0),o.append(...f)):o.appendChild(f);break;case"object":c.$is_options||o.appendChild(c);break;default:o.appendChild(document.createTextNode(c))}}return o}else return t.map(r=>{if(typeof r=="function"){let i=r;for(;typeof i=="function";)i=i(n);return i}return r})}}export function text(t){return()=>document.createTextNode(t)}function g(t,{ref:e,attr:n,classList:o,event:r,props:i}){if(e&&(t.$ref=e),o){const c=A(o);for(const f of o)f&&typeof f=="string"&&!f.includes(" ")&&t.classList.add(f.trim())}return n&&d(t,"setAttribute",n),r&&d(t,"addEventListener",r),i&&d(t,null,i),t}function A(t,e=[]){if(typeof t=="string"&&t.includes(" "))e=e.concat(t.split(" "));else if(typeof t=="string"&&!t.includes(" "))e.push(t);else if(Array.isArray(t))for(const n of t)e=A(n,e);return e}function d(t,e,n){if(Array.isArray(n))for(const o of n)for(const[r,i]of Object.entries(o))e?t[e](r,i):t[r]=i;else if(!Array.isArray(n)&&typeof n=="object")for(const[o,r]of Object.entries(n))e?t[e](o,r):t[o]=r}function $(t="",e=[]){if(!t)return;let n;for(const o of e)if(o.$ref===t){n=o;break}else n=$(t,o.children);return n}function k(t,e={}){for(const n of t)n.$ref&&typeof n.$ref=="string"&&(e[n.$ref]=n),e=k(n.children,e);return e}
